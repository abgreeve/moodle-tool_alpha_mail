define(["jquery","core/ajax","core/templates","core/popover_region_controller","core/url","core/custom_interaction_events"],function(a,b,c,d,e,f){var g=function(a){a.on(f.events.activate,'[data-action="mark-all-read"]',function(c){b.call([{methodname:"tool_alpha_mail_mark_popup_messages_as_read",args:[]}])[0].done(function(){a.find('[data-region="count-container"]').addClass("hidden"),a.find(".notification.unread").removeClass("unread")})})},h=function(a){g(a),d.call(this,a),this.root=a};return h.prototype=Object.create(d.prototype),h.prototype.constructor=h,h.prototype.renderMessages=function(){return b.call([{methodname:"tool_alpha_mail_get_popup_messages",args:[]}])[0].then(function(a){return this.renderUnreadCount(a.filter(function(a){return!a.read}).length),c.render("tool_alpha_mail/mail_popover_list",{messages:a}).done(function(a,b){c.replaceNodeContents(this.root.find(".all-notifications"),a,b)}.bind(this))}.bind(this))},h.prototype.renderUnreadCount=function(a){a>0&&this.root.find('[data-region="count-container"]').text(a).removeClass("hidden")},h});